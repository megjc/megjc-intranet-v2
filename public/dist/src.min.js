!function(){function t(t,n,e){n.otherwise({redirectTo:"/"})}function n(t,n,e,r){t.$on("$routeChangeStart",function(t,e,i){var o=r.getToken();o?r.isAuthenticated(o).then(function(t){t.success?"/login"===n.path()&&n.path("/admin"):n.path("/login")})["catch"](function(t){n.path("/login")}):n.path("/login")})}t.$inject=["$locationProvider","$routeProvider","$httpProvider"],n.$inject=["$rootScope","$location","$interval","loginService"],angular.module("intranet",["ngRoute","login","admin","dashboard"]).config(t).run(n).constant("CONFIG",{interval:1e4,api_url:"/megjc-intranet-v2"})}(),function(){"use strict";function t(t){t.when("/admin",{templateUrl:"public/app/modules/admin/tpl/admin.html",controller:"Admin as vm",resolve:{users:["AdminService",function(t){return t.getUsers()}]}}).when("/admin/users/create",{templateUrl:"public/app/modules/admin/tpl/create-user.html",controller:"User as vm"}).otherwise({redirectTo:"/admin"})}t.$inject=["$routeProvider"],angular.module("admin",[]).config(t)}(),function(){"use strict";function t(t){t.when("/dashboard",{templateUrl:"public/app/modules/dashboard/tpl/dashboard.html",controller:"Dashboard",controllerAs:"vm",resolve:{messages:["DashboardService",function(t){return t.getMessages()}]}})}t.$inject=["$routeProvider"],angular.module("dashboard",[]).config(t)}(),function(){"use strict";function t(t){t.when("/login",{templateUrl:"public/app/modules/login/tpl/login.form.html",controller:"Login",controllerAs:"vm",access:{restricted:!1,role:"any"}})}t.$inject=["$routeProvider"],angular.module("login",["ngMessages"]).config(t)}(),function(){"use strict";function t(t,n,e,r){function i(){o.users=e.length>0?e:[]}var o=this;i()}angular.module("admin").controller("Admin",t),t.$inject=["$http","$location","users","AdminService"]}(),function(){"use strict";function t(t){function n(){}function e(){i.query&&t.searchLDAP(i.query).then(function(t){i.results=t})["catch"](function(t){i.results=[]})}function r(n){n&&t.createUser(n).then(function(t){console.log(t)})["catch"](function(t){})}var i=this;i.search=e,i.create=r,n()}angular.module("admin").controller("User",t),t.$inject=["AdminService"]}(),function(){"use strict";function t(t,n,e,r){function i(){}function o(){e.logout()}var a=this;a.messages=t,a.logout=o,i()}angular.module("dashboard").controller("Dashboard",t),t.$inject=["messages","$interval","loginService","CONFIG"]}(),function(){"use strict";function t(t,n,e){function r(){}function i(n){e.authUser(o.user).then(function(r){200==r.status&&(n&&(o.user={},n.$setValidity(),n.$setPristine(),n.$setUntouched()),e.setToken(r.data.token),t.path("/admin"))})["catch"](function(t){console.log("Error: ",t)})}var o=this;o.message=!1,o.user={},o.processForm=i,r()}angular.module("login").controller("Login",t),t.$inject=["$location","$timeout","loginService"]}(),function(){"use strict";function t(t,n,e){function r(n){var r=a();return console.log(n),t.post(e.api_url+"/api/v2/admin/users",n,{headers:r}).then(function(t){return t})["catch"](function(t){return t})}function i(){var n=a();return t.get(e.api_url+"/api/v2/admin/users",{headers:n}).then(function(t){return t.data})["catch"](function(t){return t.data})}function o(n){var r=a();return t.get(e.api_url+"/api/v2/admin/ldap/search?q="+n,{headers:r}).then(function(t){return t.data})["catch"](function(t){return t})}function a(){var t=n.getToken()||"",e={Authorization:"Bearer "+t};return e}var c={getUsers:i,searchLDAP:o,createUser:r};return c}angular.module("admin").service("AdminService",t),t.$inject=["$http","loginService","CONFIG"]}(),function(){"use strict";function t(t){function n(){return{id:1,label:"Test"}}var e={getMessages:n};return e}angular.module("dashboard").service("DashboardService",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,n,e,r,i){function o(t){this.interval=t}function a(n){return t.post(i.api_url+"/api/v2/auth",n).then(function(t){return t})["catch"](function(t){return t})}function c(t){sessionStorage.setItem("_uid",t)}function u(){var t=sessionStorage.getItem("_uid");return""!=t&&null!=t&&t}function s(){sessionStorage.removeItem("_uid")}function l(n){var e={Authorization:"Bearer "+n};return t.get(i.api_url+"/api/v2/token/ack",{headers:e}).then(function(t){return t.data})["catch"](function(t){return t.data})}function d(t){switch(t){case"admin":n.path("/admin");break;default:n.path("/dashboard")}}function h(){e.cancel(this.interval)}function f(){var e=sessionStorage.getItem("_uid");if(e){var r={headers:{Authorization:"Bearer "+sessionStorage.getItem("_uid")}};t.post(i.api_url+"/api/v2/auth/token/refresh",{},r).then(function(t){400===t.data.status||500===t.data.status?n.path("/login"):sessionStorage.setItem("_uid",t.data.token)})["catch"](function(t){n.path("/login")})}else this.cancelInterval(),n.path("/login")}function s(){this.cancelInterval(),sessionStorage.clear(),n.path("/login")}var g={authUser:a,setToken:c,isAuthenticated:l,getToken:u,routeUser:d,refreshToken:f,interval:void 0,cancelInterval:h,startInterval:o,logout:s};return g}angular.module("login").service("loginService",t),t.$inject=["$http","$location","$interval","$rootScope","CONFIG"]}();