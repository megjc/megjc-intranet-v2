!function(){"use strict";function t(t){t.when("/admin",{templateUrl:"public/app/modules/admin/tpl/admin.html",controller:"Admin as vm",resolve:{users:["AdminService",function(t){return t.getUsers()}]}}).when("/admin/users/create",{templateUrl:"public/app/modules/admin/tpl/create-user.html",controller:"User as vm"}).otherwise({redirectTo:"/admin"})}t.$inject=["$routeProvider"],angular.module("admin",[]).config(t)}(),function(){function t(t,n,e){n.otherwise({redirectTo:"/"})}function n(t,n,e,r){t.$on("$routeChangeStart",function(t,e,o){var i=r.getToken();i?r.isAuthenticated(i).then(function(t){t.success?"/login"===n.path()&&n.path("/admin"):n.path("/login")})["catch"](function(t){n.path("/login")}):n.path("/login")})}t.$inject=["$locationProvider","$routeProvider","$httpProvider"],n.$inject=["$rootScope","$location","$interval","loginService"],angular.module("intranet",["ngRoute","login","admin","dashboard"]).config(t).run(n).constant("CONFIG",{interval:1e4})}(),function(){"use strict";function t(t){t.when("/dashboard",{templateUrl:"public/app/modules/dashboard/tpl/dashboard.html",controller:"Dashboard",controllerAs:"vm",resolve:{messages:["DashboardService",function(t){return t.getMessages()}]}})}t.$inject=["$routeProvider"],angular.module("dashboard",[]).config(t)}(),function(){"use strict";function t(t){t.when("/login",{templateUrl:"public/app/modules/login/tpl/login.form.html",controller:"Login",controllerAs:"vm",access:{restricted:!1,role:"any"}})}t.$inject=["$routeProvider"],angular.module("login",["ngMessages"]).config(t)}(),function(){"use strict";function t(t,n,e,r){function o(){i.users=e.length>0?e:[]}var i=this;o()}angular.module("admin").controller("Admin",t),t.$inject=["$http","$location","users","AdminService"]}(),function(){"use strict";function t(t){function n(){}function e(){o.query&&t.searchLDAP(o.query).then(function(t){o.results=t})["catch"](function(t){o.results=[]})}function r(n){n&&t.createUser(n).then(function(t){console.log(t)})["catch"](function(t){})}var o=this;o.search=e,o.create=r,n()}angular.module("admin").controller("User",t),t.$inject=["AdminService"]}(),function(){"use strict";function t(t,n,e,r){function o(){}function i(){e.logout()}var a=this;a.messages=t,a.logout=i,o()}angular.module("dashboard").controller("Dashboard",t),t.$inject=["messages","$interval","loginService","CONFIG"]}(),function(){"use strict";function t(t,n,e){function r(){}function o(n){e.authUser(i.user).then(function(r){200==r.status&&(n&&(i.user={},n.$setValidity(),n.$setPristine(),n.$setUntouched()),e.setToken(r.data.token),t.path("/admin"))})["catch"](function(t){console.log("Error: ",t)})}var i=this;i.message=!1,i.user={},i.processForm=o,r()}angular.module("login").controller("Login",t),t.$inject=["$location","$timeout","loginService"]}(),function(){"use strict";function t(t,n){function e(n){var e=i();return console.log(n),t.post("/api/v2/admin/users",n,{headers:e}).then(function(t){return t})["catch"](function(t){return t})}function r(){var n=i();return t.get("/api/v2/admin/users",{headers:n}).then(function(t){return t.data})["catch"](function(t){return t.data})}function o(n){var e=i();return t.get("/api/v2/admin/ldap/search?q="+n,{headers:e}).then(function(t){return t.data})["catch"](function(t){return t})}function i(){var t=n.getToken()||"",e={Authorization:"Bearer "+t};return e}var a={getUsers:r,searchLDAP:o,createUser:e};return a}angular.module("admin").service("AdminService",t),t.$inject=["$http","loginService"]}(),function(){"use strict";function t(t){function n(){return{id:1,label:"Test"}}var e={getMessages:n};return e}angular.module("dashboard").service("DashboardService",t),t.$inject=["$http"]}(),function(){"use strict";function t(t,n,e,r){function o(t){this.interval=t}function i(n){return t.post("/api/v2/auth",n).then(function(t){return t})["catch"](function(t){return t})}function a(t){sessionStorage.setItem("_uid",t)}function c(){var t=sessionStorage.getItem("_uid");return""!=t&&null!=t&&t}function u(){sessionStorage.removeItem("_uid")}function s(n){var e={Authorization:"Bearer "+n};return t.get("/api/v2/token/ack",{headers:e}).then(function(t){return t.data})["catch"](function(t){return t.data})}function l(t){switch(t){case"admin":n.path("/admin");break;default:n.path("/dashboard")}}function d(){e.cancel(this.interval)}function h(){var e=sessionStorage.getItem("_uid");if(e){var r={headers:{Authorization:"Bearer "+sessionStorage.getItem("_uid")}};t.post("/api/v2/auth/token/refresh",{},r).then(function(t){400===t.data.status||500===t.data.status?n.path("/login"):sessionStorage.setItem("_uid",t.data.token)})["catch"](function(t){n.path("/login")})}else this.cancelInterval(),n.path("/login")}function u(){this.cancelInterval(),sessionStorage.clear(),n.path("/login")}var f={authUser:i,setToken:a,isAuthenticated:s,getToken:c,routeUser:l,refreshToken:h,interval:void 0,cancelInterval:d,startInterval:o,logout:u};return f}angular.module("login").service("loginService",t),t.$inject=["$http","$location","$interval","$rootScope"]}();